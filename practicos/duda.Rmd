---
geometry: margin=1.5cm
output: pdf_document
header-includes:
  \usepackage{fvextra}
  \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.dim = c(6, 3.5), fig.align='center', message=FALSE, warning=FALSE)
library(knitr)
```

# Kolmogorov-Smirnov: Pr치ctico 9, ejercicio 1.

```{r echo=FALSE}
datos <- c(5.3,5.1,4.8,4.9,5.3,5.2,5.8,5.5,5.6,5.2)
x <- seq(4.7, 5.9, 0.12)
par(mar=c(2,2,2,2))
```

La distribuci칩n conocida es $Unif(4.7, 5.9)$. Y los datos son: [`r datos`]. La prueba de hip칩tesis tiene la siguiente forma:

$$\left\{\begin{matrix}
H_{0}: F_{x}=Unif(4.7, 5.9)\\ 
H_{1}: F_{x}\neq Unif(4.7, 5.9)
\end{matrix}\right.$$

Primero se plantea Kolmogorov-Smirnov:
$$K_{n}=D \times \sqrt{n} \rightarrow  \mathcal{K}$$
Segundo la RC tiene la forma de:
$$RC=\left \{ \sqrt{n} \times D > t_{1-\alpha} \right \}$$ 
Ahora se continua hallando el valor de _D_.
$$D=sup\left | F_{X}(x)-F_{0}(x) \right |$$
$$D=0.7-0.5 = 0.2$$
Como $n<30$ utilizamosla tabla y buscamos el valor de $t_{1-\alpha}$, para $n=10$ y $\alpha = 0.05$:
$$t_{1-\alpha}=0.40925$$

Finalmente:

$$RC=\left \{ D \times \sqrt{n} > 0.40925 \right \}$$

Ya que $D \times \sqrt{n}=0.63$ es m치s grande que $t_{1-\alpha}$ se puede decir que rechazamos $H_{0}$.

```{r echo=FALSE}
par(mar = c(2,2,2,2))
plot(x, punif(x, min = 4.7, max = 5.9), type = "l", ylim = c(0,1))
lines(ecdf(datos))
abline(h=c(0.5, 0.7), v=datos[5], lty=2, col=c("blue", "red", "grey"))
```

``` {r}
test_ks <- ks.test(datos,"punif", 4.7, 5.9)
```

Al realizar el ejercicio en R obtenemos D =`r test_ks$statistic` y un p-valor =`r round(test_ks$p.value, 3)`, ya que el _p-valor_ es mayor a _0.05_ podemos decir que no hay evidencias significativas como para rechazar $H_{0}$. Y esto es completamente lo contrario a lo que nos da al calcular _"a mano"_, donde rechazabamos $H_{0}$

